name: Run kurobako benchmark
on:
  pull_request:
    paths:
    - '.github/workflows/benchmarks.yml'
    - 'cmaes/**.py'
    - 'benchmark/*.py'
    - 'benchmark/runner.sh'
jobs:
  benchmark-six-hump-camel:
    name: Run kurobako benchmark
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@master
      - uses: actions/setup-python@v2
        with:
          python-version: '3.8'
          architecture: 'x64'
      - run: pip install -U pip setuptools
      - run: python setup.py develop
      - run: pip install --progress-bar off -e '.[benchmark]'
      - run: pip install --progress-bar off -U git+https://github.com/sile/kurobako-py
      - run: pip install --progress-bar off -U git+https://github.com/c-bata/optuna.git@ipop-cma-es
      - run: pip install packaging
      - uses: CyberAgent/cmaes/benchmark/action@composite-action
        with:
          problem: 'six-hump-camel'

  benchmark-rastrigin:
    name: Run kurobako benchmark
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@master
      - uses: actions/setup-python@v2
        with:
          python-version: '3.8'
          architecture: 'x64'
      - run: pip install -U pip setuptools
      - run: python setup.py develop
      - run: pip install --progress-bar off -e '.[benchmark]'
      - run: pip install --progress-bar off -U git+https://github.com/sile/kurobako-py
      - run: pip install --progress-bar off -U git+https://github.com/c-bata/optuna.git@ipop-cma-es
      - run: pip install packaging

      - uses: CyberAgent/cmaes/benchmark/action@composite-action
        with:
          problem: 'rastrigin'
